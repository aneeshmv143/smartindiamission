{% extends "siteadmin_base.html" %}
{% block content %}
<section id="main-content">
    <section class="wrapper">            
        <!--overview start-->
       <div class="row">
        <div class="col-lg-12">
            <h3 class="page-header"><i class="fa fa-laptop"></i> Course List</h3>
            <ol class="breadcrumb">
                <li><i class="fa fa-home"></i><a href="/siteadmin/dashboard/">Home</a></li>
                <li><i class="fa fa-laptop"></i>Course List</li>                          
            </ol>
        </div>
       </div>
      
        <div class="row">
            <div class="col-lg-4 pull-right">
                <select id="course_category" name="course_category" class="form-control">
                    <option value="0">Select Course Category</option>
                    {% for category in course_categories %}
                    <option value="{{category.pk}}">{{category.title}}</option>
                    {% endfor %}
                </select>
            </div>     
        </div><!--/.row-->
        <div class="row">
            <div class="col-lg-8" >
                {% if course_edited %}
                <div class="alert alert-success fade in">
                    <button data-dismiss="alert" class="close close-sm" type="button">
                        <i class="icon-remove"></i>
                    </button>
                    <strong>Well done!</strong> Course details edited successfully!
                </div> 
                {% endif %}              
                <section class="panel">
                    <header class="panel-heading">
                        <span id="course_title">Course</span>
                    </header>
                    <table class="table table-striped table-advance table-hover">
                        <thead>
                            <tr>
                                <th>Course Code</th>
                                <th>Course Name</th>
                                <th>Duration</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="course">
                        
                        </tbody>
                        </table>
                      </section>
                  </div>
              </div>

    </section>    
</section>
{% endblock %}

{% block custom_js %}

<script type="text/javascript">
    $('#course_category').change(function(e){
        e.preventDefault();
        $('#course').html('');
        var id = $(this).val();
        if (id === ''){
           return;
        }
        $.ajax({
            type  : 'GET',
            url   : '/siteadmin/ajax/courses/',
            cache : false,
            data  : 'course_category=' + id,
            success : function(data){
                var data = JSON.parse(data);
                for(i=0; i< data.length; i++){
                        $('#course').append('<tr>'+'<td>' + data[i].fields.code +'</td><td>'+data[i].fields.name+'</td><td>'+data[i].fields.duration+'</td>'+ '<td><div class="btn-group">'+
                                      '<a class="btn btn-success" href="/siteadmin/course/edit/?course='+data[i].pk+'"><i class="icon_check_alt2"></i></a>'+
                                      '<a class="btn btn-danger" href="#"><i class="icon_close_alt2"></i></a>'+
                                  '</div></td>'+'</tr>')
                    } 
                },  
            error : function(data){
                alert('Please Select Course Category')
            }
        });
    });    
</script>
{% endblock %}